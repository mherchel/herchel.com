webpackJsonp([0xb4ce09af99d7],{408:function(n,s){n.exports={data:{site:{siteMetadata:{title:"Mike Herchel",author:"Mike Herchel"}},markdownRemark:{id:"/Users/mherchel/sites/herchel.com/src/blog/2018-01-21-css-variables-react/index.md absPath of file >>> MarkdownRemark",html:'<p>I added an <a href="https://en.wikipedia.org/wiki/Easter_egg_(media)">easter egg</a> to my blog last week. If you click and drag the background (you have to be on a screen wider than 1200px to do so), the page’s primary color will change. It’s pretty silly, but I had a lot of fun doing it and <em>I think</em> it looks pretty sweet. </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/sweet-6f662da264049db57e99d9ce6f13105e-db238.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 371px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 101.07816711590296%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAQEAAwAAAAAAAAAAAAAAAAMBAgQF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAGdpbPaczmeg+gC/8QAHBAAAgICAwAAAAAAAAAAAAAAAQIAAxESITEy/9oACAEBAAEFAnbQIazK/JG0p5C9AARGzbgT/8QAFREBAQAAAAAAAAAAAAAAAAAAASD/2gAIAQMBAT8BI//EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAECAQE/AWP/xAAZEAEAAwEBAAAAAAAAAAAAAAABABARMRL/2gAIAQEABj8CVNm+QpGcrZmE5P/EABwQAAMAAwADAAAAAAAAAAAAAAABESExYUFxsf/aAAgBAQABPyFLKRub9mF8VyK5uxXhKK9jCh9hY5z0rSLiKN4H/9oADAMBAAIAAwAAABAwGEL/xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QIjsJ/8QAFREBAQAAAAAAAAAAAAAAAAAAEAH/2gAIAQIBAT8QNP/EAB0QAQEAAwADAQEAAAAAAAAAAAERACExUYGRsdH/2gAIAQEAAT8QSQDWEsfs+YTKAxzxDeIZNRfhk9bL1vGtS0o7xxHJx6MJAWvkdxEDOMHd/uWDS+M//9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Napoleon Dynamite Meme"\n        title=""\n        src="/static/sweet-6f662da264049db57e99d9ce6f13105e-db238.jpg"\n        srcset="/static/sweet-6f662da264049db57e99d9ce6f13105e-cc1ac.jpg 200w,\n/static/sweet-6f662da264049db57e99d9ce6f13105e-db238.jpg 371w"\n        sizes="(max-width: 371px) 100vw, 371px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Here’s a <a href="/color-changing-variables-3d97eb494983fc187426096de03f47ff.mp4">video of the color changing in action</a>, just in case you’re on mobile.</p>\n<p>Anywho… here’s how it’s done and why it’s performant.</p>\n<h2>First, let’s set up the fixed background</h2>\n<p>Before we can start messing with CSS variables or React, let’s get the background setup.</p>\n<p>My default background color is <code>deepskyblue</code>. </p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> deepskyblue<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>For the background image, I’m using a pattern from <a href="https://www.toptal.com/designers/subtlepatterns/">Subtle Patterns</a> that can be downloaded <a href="https://www.toptal.com/designers/subtlepatterns/subtle-grey/">here</a>. </p>\n<p>We want the background image to be fixed (meaning that it won’t move when scrolled). But, that introduces a performance issue: When scrolling on a page that has <code>background-attachment: fixed;</code>, the browser will continuously <a href="https://developers.google.com/web/fundamentals/performance/rendering/simplify-paint-complexity-and-reduce-paint-areas">repaint</a> while you’re scrolling. This is expensive for the CPU, and can often lead to situations where the page acts “janky” while scrolling. </p>\n<p>To work around this, we create a <code>::before</code> pseudo-element on the <code>&#x3C;body></code> element, and set it to <code>position: fixed;</code>. We then promote it to its own <a href="https://www.html5rocks.com/en/tutorials/speed/layers/">composite layer</a> using <code>backface-visibility: hidden;</code>. This will mitigate any scrolling issues.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">body:before</span> <span class="token punctuation">{</span>\n  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span> <span class="token comment">/* This will not scroll with the page. */</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span> <span class="token comment">/* Make sure it appears behind any content. */</span>\n  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>\n  <span class="token property">backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token comment">/* This is what promotes it to its own layer. */</span>\n  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(/bg.jpg)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Now the background image is taking up the full width of the screen and doesn’t scroll — but, it doesn’t look right yet. We cannot see the color underneath.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/bg-1-55dbd25f30cc4ef2e12f2bfce64f1ee9-5a312.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB2bCAf//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABcQAQADAAAAAAAAAAAAAAAAAAEAEDH/2gAIAQEAAT8h2BX/2gAMAwEAAgADAAAAEPPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRABAQADAQAAAAAAAAAAAAAAAREAECGh/9oACAEBAAE/EICJRzst81//2Q==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Screenshot"\n        title=""\n        src="/static/bg-1-55dbd25f30cc4ef2e12f2bfce64f1ee9-893a4.jpg"\n        srcset="/static/bg-1-55dbd25f30cc4ef2e12f2bfce64f1ee9-bbf57.jpg 200w,\n/static/bg-1-55dbd25f30cc4ef2e12f2bfce64f1ee9-260b8.jpg 400w,\n/static/bg-1-55dbd25f30cc4ef2e12f2bfce64f1ee9-893a4.jpg 800w,\n/static/bg-1-55dbd25f30cc4ef2e12f2bfce64f1ee9-5a312.jpg 1000w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>To fix this, we need to grayscale the image, invert the colors, and then add an opacity. We do all of this via CSS:</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">body:before</span> <span class="token punctuation">{</span>\n  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>\n  <span class="token property">backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>\n  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url(/bg.jpg)</span><span class="token punctuation">;</span>\n\n  <span class="token comment">/* New stuff down here. */</span>\n  <span class="token property">opacity</span><span class="token punctuation">:</span> 0.4<span class="token punctuation">;</span>\n  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">grayscale</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span> <span class="token function">invert</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Here’s what it looks like now.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/bg-2-0ded599dd9fcad4d0056dac216044036-5a312.jpg"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAUD/8QAFgEBAQEAAAAAAAAAAAAAAAAAAwIE/9oADAMBAAIQAxAAAAHG4LnhCy//xAAVEAEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAQABBQIv/8QAFREBAQAAAAAAAAAAAAAAAAAAAxD/2gAIAQMBAT8BOf/EABURAQEAAAAAAAAAAAAAAAAAAAIQ/9oACAECAQE/AXP/xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAWEAEBAQAAAAAAAAAAAAAAAAAAATH/2gAIAQEAAT8h2i6//9oADAMBAAIAAwAAABD0L//EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAwEBPxB4z//EABYRAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxCgv//EABsQAAEEAwAAAAAAAAAAAAAAAAEAESFBMVFx/9oACAEBAAE/EGxIBe9IoJejSydX/9k=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"\n        alt="Screenshot"\n        title=""\n        src="/static/bg-2-0ded599dd9fcad4d0056dac216044036-893a4.jpg"\n        srcset="/static/bg-2-0ded599dd9fcad4d0056dac216044036-bbf57.jpg 200w,\n/static/bg-2-0ded599dd9fcad4d0056dac216044036-260b8.jpg 400w,\n/static/bg-2-0ded599dd9fcad4d0056dac216044036-893a4.jpg 800w,\n/static/bg-2-0ded599dd9fcad4d0056dac216044036-5a312.jpg 1000w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Looking good! But, we still need to add that sweet fade that’s near the top. To do this, we’re using a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/linear-gradient">linear-gradient</a> fading between <code>deepskyblue</code> and <code>transparent</code>. </p>\n<p>Because we also do not want this to scroll, we’re using the <code>::after</code> pseudo element on the <code>body</code> tag in a similar fashion to what we did before.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">body:after</span> <span class="token punctuation">{</span>\n  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>\n  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>\n  <span class="token property">z-index</span><span class="token punctuation">:</span> -1<span class="token punctuation">;</span>\n  <span class="token property">backface-visibility</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>\n  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>\n  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to bottom, deepskyblue, transparent 70%<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Now it looks right! But, there’s a problem. We’re declaring <code>deepskyblue</code> twice. What can we do about that?</p>\n<h2>CSS Variables to the rescue!</h2>\n<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables">CSS Variables</a> (aka CSS Custom Properties) are awesome, but don’t confuse them with Sass variables. The difference with CSS Variables is that they can be changed at runtime. Let’s get started. </p>\n<p>First we’ll add the variable to the <code>:root</code> element (which is the <code>&#x3C;html></code> element). We call this <code>--primary</code> because it’s the primary color. Variables are always prepended with double-hyphens.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">:root</span> <span class="token punctuation">{</span>\n  <span class="token property">--primary</span><span class="token punctuation">:</span> deepskyblue<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Then we can change around the background color, and the linear-gradient using the <code>var()</code> function.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--primary<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">body:after</span> <span class="token punctuation">{</span>\n  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>to bottom, <span class="token function">var</span><span class="token punctuation">(</span>--primary<span class="token punctuation">)</span>, transparent 70%<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>While we’re at it, let’s change the colors of hyperlinks and <code>h3</code> tags.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">.content a</span> <span class="token punctuation">{</span>\n  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--primary<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">h3</span> <span class="token punctuation">{</span>\n  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--primary<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">brightness</span><span class="token punctuation">(</span>75%<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Let\'s darken this a bit. */</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Looking good, but how can we manipulate the colors?</p>\n<h2>Convert the colors to HSLA</h2>\n<p>We’re going to use HSLA colors here. HSLA stands for <strong>H</strong>ue, <strong>S</strong>aturation, <strong>L</strong>ightness, and <strong>A</strong>lpha. This means that we can change the any of these values individually.</p>\n<p>We can use an <a href="https://www.w3schools.com/colors/colors_converter.asp">online color converter</a> to convert from <code>deepskyblue</code> to HSLA.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">hsl</span><span class="token punctuation">(</span>195, 100%, 50%, 1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* This is the same as deepskyblue. */</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Because we’re planning on manipulating the hue and lightness separately, let’s split each value into their own CSS variable and <em>then</em> combine all of those into the <code>--primary</code> variable.</p>\n<div class="gatsby-highlight">\n      <pre class="language-css"><code><span class="token selector">:root</span> <span class="token punctuation">{</span>\n  <span class="token property">--primary</span><span class="token punctuation">:</span> <span class="token function">hsla</span><span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--primary-hue<span class="token punctuation">)</span>, \n                  <span class="token function">var</span><span class="token punctuation">(</span>--primary-saturation<span class="token punctuation">)</span>, \n                  <span class="token function">var</span><span class="token punctuation">(</span>--primary-lightness<span class="token punctuation">)</span>, \n                  <span class="token function">var</span><span class="token punctuation">(</span>--primary-alpha<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token property">--primary-hue</span><span class="token punctuation">:</span> 195<span class="token punctuation">;</span>\n  <span class="token property">--primary-saturation</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>\n  <span class="token property">--primary-lightness</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>\n  <span class="token property">--primary-alpha</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p><em>Now we’re cooking with gas… err… variables!</em></p>\n<p>Pretty neat! But, we still need to be able to manipulate these variables with React.</p>\n<h2>Bringing in ReactJS</h2>\n<p>Updating the variables would be pretty easy to do with vanilla JavaScript, but since this blog is using <a href="https://reactjs.org/">ReactJS</a>, we’re going to make use of that.</p>\n<p>The first thing we need to do is keep track of current <em>hue</em> and <em>lightness</em> via React’s state system. </p>\n<h3>Set up state</h3>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Template</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>\n      hue<span class="token punctuation">:</span> <span class="token number">195</span><span class="token punctuation">,</span>\n      lightness<span class="token punctuation">:</span> <span class="token number">50</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token operator">...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<h3>Track mouse movement</h3>\n<p>Next, we track the mouse movement within the <code>handleMouseMove</code> method, where we calculate and then update the hue and lightness based on the mouse’s X and Y position.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Template</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>\n      hue<span class="token punctuation">:</span> <span class="token number">195</span><span class="token punctuation">,</span>\n      lightness<span class="token punctuation">:</span> <span class="token number">50</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">handleMouseMove</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> hueIncrement <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight <span class="token operator">/</span> <span class="token number">360</span>\n    <span class="token keyword">const</span> mouseYPositionPercent <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientY <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>\n    <span class="token keyword">const</span> hue <span class="token operator">=</span> mouseYPositionPercent <span class="token operator">*</span> hueIncrement\n    <span class="token keyword">const</span> lightness <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX <span class="token operator">/</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span>\n\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> hue<span class="token punctuation">,</span> lightness <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>We pass the event object into this method. <code>e.clientX</code> and <code>e.clientY</code> will return the mouse’s position within the viewport.</p>\n<h3>Set up event listeners</h3>\n<p>The <code>handleMouseMove</code> method won’t fire unless we activate an event listener and point it to the method. For performance reasons, we only want the event listener to be active when the mouse button is actively being pressed.</p>\n<p>To do this, we set up <code>handleMouseDown</code> and <code>handleMouseUp</code> methods that will be called when the <code>mousedown</code> and <code>mouseup</code> events are triggered.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Template</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseDown <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseDown<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseUp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseUp<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>\n      mousedown<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n      hue<span class="token punctuation">:</span> <span class="token number">195</span><span class="token punctuation">,</span>\n      lightness<span class="token punctuation">:</span> <span class="token number">50</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">handleMouseDown</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>layoutStyles<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, .</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>layoutStyles<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> *`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> mousedown<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">\'mousemove\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">handleMouseUp</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> mousedown<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">\'mousemove\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseMove<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>We again pass the event object to the <code>handleMouseDown</code> method. We need to check if the initial click target (which is <code>e.target</code>) is outside of the content area. This is what verifies that the user initially clicked on the background before they started dragging their mouse. </p>\n<p>We use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/matches">element.matches()</a> API, which takes a standard selector (similar to what <code>document.querySelectorAll()</code> does). We then pass in a selector. This blog uses <a href="https://github.com/emotion-js/emotion">Emotion JS</a> to handle styling, so we have to pass in the same <code>layoutStyles</code> variable that we pass to Emotion. A couple of notes here:</p>\n<ul>\n<li>We’re adding a dot <code>.</code> to the beginning of the <code>layoutStyles</code> variable because this is a class name selector.</li>\n<li>We also check to see if the click target is a descendent of <code>layoutStyles</code> by using a <code>*</code> descendent selector.</li>\n</ul>\n<p>Only if those selectors <em>do not</em> match, do we change the mousedown state and add an event listener for <code>mousemove</code>.</p>\n<p>We also have a method for handling the <code>mouseup</code> event that changes state and removes the event listener (for performance reasons) when the user stops pressing the mouse.</p>\n<h3>Set up event listeners for mouseup and mousedown</h3>\n<p>We now have our <code>mousemove</code> event listener set up, but we still need event listeners for the <code>mouseup</code> and <code>mousedown</code> events. </p>\n<p>To enable these, we place them within React’s <a href="https://reactjs.org/docs/react-component.html#componentdidmount">componentDidMount()</a> lifecycle method, which is invoked immediately after a component is mounted. </p>\n<p>From these event listeners, we call the <code>handleMouseDown</code> and <code>handleMouseUp</code> events, which can then create the <code>mousemove</code> event listener.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Template</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseDown <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseDown<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseUp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseUp<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// ..</span>\n  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">\'mousedown\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseDown<span class="token punctuation">)</span>\n    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">\'mouseup\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseUp<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">\'mousedown\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseDown<span class="token punctuation">)</span>\n    document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">\'mouseup\'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleMouseUp<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// ...</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Note that we’re also removing the event listeners when the component will unmount. This is best practice.</p>\n<p>So at this point, we’re updating React’s state whenever the user drags their mouse starting at the background of the page. But how are we going to update the CSS variables with this information?</p>\n<h2>Updating CSS Variables with React</h2>\n<p>The next goal is to inject a <code>&#x3C;style></code> tag into my page’s <code>&#x3C;head></code> tag. Within this, I can place new CSS to override the original CSS. </p>\n<p>To place the <code>&#x3C;style></code> within the <code>&#x3C;head></code>, I’m using the <a href="https://github.com/nfl/react-helmet">React Helmet</a> library (which was developed by the <a href="https://github.com/nfl">NFL</a> — cool!).</p>\n<blockquote>\n<p>This reusable React component will manage all of your changes to the document head. Helmet takes plain HTML tags and outputs plain HTML tags.</p>\n</blockquote>\n<p>Let’s get started.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Template</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>layoutStyles<span class="token punctuation">}</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>Helmet<span class="token operator">></span>\n          <span class="token operator">&lt;</span>style<span class="token operator">></span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`\n            :root {\n              --primary-hue: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;\n              --primary-lightness: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>lightness<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%;\n              }\n            `</span></span><span class="token punctuation">}</span>\n          <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span>\n        <span class="token operator">&lt;</span><span class="token operator">/</span>Helmet<span class="token operator">></span>\n        <span class="token comment">// ...</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>This is easy! Now when we drag the mouse, the CSS variables will get overridden.</p>\n<p>We have one issue, though. When dragging the mouse across the screen, it highlights all of the text. To remediate this, we temporarily disable the ability to select text with the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/user-select">user-select</a> CSS property. We only activate this when the mousedown state is set to <code>true</code>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Template</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token comment">// ...</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>layoutStyles<span class="token punctuation">}</span><span class="token operator">></span>\n        <span class="token operator">&lt;</span>Helmet<span class="token operator">></span>\n          <span class="token operator">&lt;</span>style<span class="token operator">></span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`\n            :root {\n              --primary-hue: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;\n              --primary-lightness: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>lightness<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%;\n              -webkit-user-select: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>mousedown <span class="token operator">?</span> <span class="token string">\'none\'</span> <span class="token punctuation">:</span> <span class="token string">\'auto\'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;\n              -moz-user-select: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>mousedown <span class="token operator">?</span> <span class="token string">\'none\'</span> <span class="token punctuation">:</span> <span class="token string">\'auto\'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;\n              user-select: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>mousedown <span class="token operator">?</span> <span class="token string">\'none\'</span> <span class="token punctuation">:</span> <span class="token string">\'auto\'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;\n              }\n            `</span></span><span class="token punctuation">}</span>\n          <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span>\n        <span class="token operator">&lt;</span><span class="token operator">/</span>Helmet<span class="token operator">></span>\n        <span class="token comment">// ...</span>\n      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>Note that we have to use prefixed versions of the property for Safari and Firefox.</p>\n<h2>Conclusion</h2>\n<p>Hopefully you’ve learned a little about CSS Variables and React. CSS Variables are <a href="https://caniuse.com/#search=css%20variables">supported in all the major browser versions</a>, but are not supported in Internet Explorer 11 (which is depreciated by Edge).</p>\n<p>The code examples in this post are a little bit simplified. The full implementation can be <a href="https://github.com/mherchel/herchel.com/blob/master/src/layouts/index.js">viewed on GitHub</a>. Check it out!</p>\n<p><em>Thanks to <a href="https://twitter.com/larkintuckerllc">John Tucker</a> for helping to review this post.</em></p>',
excerpt:"I added an  easter egg  to my blog last week. If you click and drag the background (you have to be on a screen wider than 1200px to do so…",frontmatter:{title:"Making Rainbows 🌈 with CSS Variables and React",date:"January 21, 2018",author:null}}},pathContext:{slug:"/2018-01-21-css-variables-react/"}}}});
//# sourceMappingURL=path---2018-01-21-css-variables-react-b4f24cfd4a8478020c64.js.map